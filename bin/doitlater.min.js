!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.doitlater=e.doitlater||{})}(this,function(e){"use strict";var n=[{ext:/(png|jpg|jpeg|gif|apng|svg|bmp|ico)$/,load:function(e,n){var t=new Image;t.onload=function(){n(t)},t.src=e}},{ext:/(js)$/,load:function(e,n){var t=document.createElement("script");t.onload=function(){n(t)},t.src=e,document.getElementsByTagName("head")[0].appendChild(t)}},{ext:/(css)$/,load:function(e,n){var t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t),n(t)}},{ext:/(html)$/,load:function(e,n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&t.responseText.length>0&&n(t.responseText)},t.send()}},{ext:/(json)$/,load:function(e,n,t){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){if(o.status>=200&&o.status<400){var e=JSON.parse(o.responseText);n(e)}else t()},o.onerror=t,o.send()}}],t=window.requestIdleCallback||window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,16)},o=function(){var e={};return e.promise=new Promise(function(n,t){e.resolve=n,e.reject=t}),e},r={},i=function(e){return r[e]||(r[e]=o())},a=function(e,n){var t=i(e);return n.then(t.resolve,t.reject),t.promise};e.runLater=t,e.createDefer=o,e.waitFor=function(e){return i(e).promise},e.add=a,e.load=function(e,o){o.constructor!==Array&&(o=[o]);var r=o.map(function(e){return new Promise(function(o,r){t(function(){if("function"==typeof e)e(),o();else{var t=e.split(".").pop(),i=n.find(function(e){return e.ext.test(t)});if(!i)throw new Error("Loader for <"+t+"> files has not been implemented yet");i.load(e,o,r)}})})});return a(e,Promise.all(r))},Object.defineProperty(e,"__esModule",{value:!0})});
