!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.doitlater=e.doitlater||{})}(this,function(e){"use strict";var t=[{ext:/(png|jpg|jpeg|gif|apng|svg|bmp|ico)$/,load:function(e,t){var n=new Image;n.onload=function(){t(n)},n.src=e}},{ext:/(js)/,load:function(e,t){var n=document.createElement("script");n.onload=function(){t(n)},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}},{ext:/(css)/,load:function(e,t){var n=document.createElement("link");n.rel="stylesheet",n.href=e,document.head.appendChild(n),t(n)}},{ext:/(html)/,load:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&n.responseText.length>0&&t(n.responseText)},n.send()}},{ext:/(json)/,load:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),request.onload=function(){if(request.status>=200&&request.status<400){var e=JSON.parse(request.responseText);t(e)}else reject()},request.onerror=reject,n.send()}}],n=window.requestIdleCallback||window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,16)},o=function(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e},r={},i=function(e){return r[e]||(r[e]=o())};e.runLater=n,e.createDefer=o,e.get=function(e){return i().promise},e.add=function(e,t){return i().promise=t},e.load=function(e,o,r){"string"==typeof o&&(o=[o]);var s=o.map(function(e){return new Promise(function(o,i){(r||Promise.resolve()).then(function(){n(function(){if("function"==typeof e)e(),o();else{var n=e.split(".").pop(),r=t.find(function(e){return e.ext.test(n)});if(!r)throw new Error("Loader for <"+n+"> files has not been implemented yet");r(e,o,i)}})})})});return i(e).promise=Promise.all(s)},Object.defineProperty(e,"__esModule",{value:!0})});
